!function(){"use strict";function a(){var a;return this.init=function(b){a=b||{}},this.$get=["$rootScope","$q","$log",function(b,c,d){function e(a){return function(){var c=a.apply(this,arguments);return b.$apply(),c}}var f,g=c.defer(),h=g.promise,i=c.defer(),j=function(a,c,d){return b.$broadcast("$wamp.onchallenge",{promise:i,session:a,method:c,extra:d}),i.promise};a=angular.extend({onchallenge:e(j),use_deferred:c.defer},a),f=new autobahn.Connection(a),f.onopen=e(function(a){d.debug("Congrats!  You're connected to the WAMP server!"),b.$broadcast("$wamp.open",a),g.resolve()}),f.onclose=e(function(a,c){d.debug("Connection Closed: ",a),b.$broadcast("$wamp.close",{reason:a,details:c})});var k=function(a,d,g,h){var i,j,k={},l=c.defer();return d=e(d),j=function(){var b=f.session.subscribe(a,d,g).then(function(a){return k=angular.extend(a,k),l.resolve(k),a});h&&h(b)},f.isOpen&&j(),i=b.$on("$wamp.open",j),k.promise=l.promise,k.unsubscribe=function(){return i(),f.session.unsubscribe(k)},k};return{connection:f,open:function(){f.open()},close:function(){f.close()},subscribe:function(a,b,c,d){return k(a,b,c,d).promise},unsubscribe:function(a){return a.unsubscribe()},publish:function(a,b,d,e){var g=c.defer();return h.then(function(){var c=f.session.publish(a,b,d,e);c?c.then(function(a){g.resolve(a)}):g.resolve(!0)}),g.promise},register:function(a,b,d){b=e(b);var g=c.defer();return h.then(function(){f.session.register(a,b,d).then(function(a){g.resolve(a)})}),g.promise},call:function(a,b,d,e){var g=c.defer();return h.then(function(){f.session.call(a,b,d,e).then(function(a){g.resolve(a)})}),g.promise}}}],this}angular.module("vxWamp",[]).provider("$wamp",a)}();